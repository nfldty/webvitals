(()=>{var T=Object.create;var p=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var R=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var x=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var d=(e,t)=>()=>(e&&(t=e(e=0)),t);var A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var M=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of y(t))!I.call(e,o)&&o!==n&&p(e,o,{get:()=>t[o],enumerable:!(r=U(t,o))||r.enumerable});return e};var C=(e,t,n)=>(n=e!=null?T(R(e)):{},M(t||!e||!e.__esModule?p(n,"default",{value:e,enumerable:!0}):n,e));function H(e){let t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,o=0;for(;o<e;)t+=n.charAt(Math.floor(Math.random()*r)),o+=1;return t}function i(){return g.webvitals||(g.webvitals={}),g.webvitals}async function P(e,t,n,r,o){return i().io||(i().io=(await import("https://cdn.socket.io/4.7.2/socket.io.esm.min.js")).io),i().socket&&i().socket.connected||(sessionStorage["webvitals-session-id"]||(sessionStorage["webvitals-session-id"]=H(32)),i().userId=1,i().socket=i().io(e,{auth:{session_id:sessionStorage["webvitals-session-id"],user_id:i().userId}}),n&&i().socket.on("connect",()=>n(i().socket)),t&&i().socket.on("message",f=>t(f)),r&&i().socket.on("disconnect",r),o&&i().socket.on("connect_error",o)),i().socket}async function c(e,t){console.log("sending",e,t);let n=await P("http://localhost:3000",null,null,null,null);e&&t&&n.emit(e,t)}var g,k,u=d(()=>{g=window||global,k=document.querySelector("script[data-webvitals-widget]");if(k){let e=k.getAttribute("data-user-id");i().userId=e,console.log("Webvitals initialized with user: ",e)}});function D(){let e=0,t=1e3,n=[],r=3,o=1e3,f=2e3;function L(s,a){let l=Date.now();l-e>=t&&(c("mouse_move",{x:s,y:a,timestamp:l}),e=l)}function E(s,a){c("rage_click",{x:s,y:a,timestamp:Date.now()})}function S(){c("quick_back",{timestamp:Date.now()})}document.addEventListener("mousemove",function(s){let a=s.clientX,l=s.clientY;L(a,l)}),document.addEventListener("click",function(s){let a=Date.now();n.push(a),n=n.filter(l=>a-l<=o),n.length>=r&&(console.log("Rage click detected"),E(s.clientX,s.clientY),n=[])}),window.addEventListener("pageshow",function(s){if(s.persisted||performance.getEntriesByType("navigation")[0].type==="back_forward"){let a=Date.now();window.lastPageLeave&&a-window.lastPageLeave<f&&(console.log("Quick back detected"),S())}}),window.addEventListener("pagehide",function(){window.lastPageLeave=Date.now()})}var h=d(()=>{u()});function w(){let e=Date.now(),t=0;document.addEventListener("visibilitychange",()=>{document.hidden?t=Date.now()-e:e=Date.now()}),window.addEventListener("beforeunload",()=>{t=Date.now()-e,console.log("sending",t),c("time_tracker",{time_spent:t})})}var v=d(()=>{u();w()});function m(){return{fullUrl:window.location.href,origin:window.location.origin,pathname:window.location.pathname}}function b(){let e=m();c("page_visit",{page_url:e.fullUrl}),window.addEventListener("popstate",function(){let t=m();storeUrlDetails(t),c("page_visit",{page_url:t.fullUrl})}),document.body.addEventListener("click",function(t){if(t.target.tagName==="A"&&t.target.href&&new URL(t.target.href).origin===window.location.origin){t.preventDefault(),history.pushState({},"",t.target.href);let n=m();storeUrlDetails(n),console.log("sending",n.fullUrl),c("page_visit",{page_url:n.fullUrl})}})}var _=d(()=>{u()});var B=A(()=>{h();v();_();D();w();b()});B();})();
